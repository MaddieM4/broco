/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

define("broco/logic/lex",[],function(){function t(t){for(var n=0;n<e.length;n++)if(t==e[n])return!0;return!1}var e=['"',"'","`"];return function(e){var n="",r=undefined,i=[];for(var s=0;s<e.length;s++){var o=e[s];r!=undefined?o==r?(i.push(n),n="",r=undefined):n+=o:n==""&&t(o)?r=o:o==" "?n&&(i.push(n),n=""):n+=o}return(n||r)&&i.push(n),i}}),define("broco/logic/console",["broco/logic/lex"],function(e){function n(){this.modules={},this.data={modules:this.modules,prefs:{}},this.depend("broco/modules/",t)}var t=["set","get","clear"];return n.prototype.depend=function(e,t,n,r){var i=this,s=[],o=[];for(var u=0;u<t.length;u++){var a=t[u].replace("/",".");s.push(a),o.push((e+a).replace(".","/"))}require(o,function(){for(var e=0;e<t.length;e++){var r=s[e],o=arguments[e];i.modules[r]=new o(i)}n!=undefined&&n()},r)},n.prototype.process=function(t,n){var r=e(t),i=r[0];if(this.modules[i]!=undefined){var s=this.modules[i];s.process(r,n)}else n.print("No module loaded for command '"+i+"'",["broco-entry-error"])},n}),define("broco/ui/util",[],function(){return{newClassDiv:function(e){var t=document.createElement("div");return t.classList.add(e),t}}}),define("broco/ui/stringtracker",[],function(){function n(e,t,n,r){this.on_change=t,this.on_submit=n,this.element=this._setup_element(e,r),this.focus()}var e={BACKSPACE:8,SPACE:32,ENTER:13},t=["keyup","keydown","keypress","input"];return n.prototype._setup_element=function(e,n){var r=document.createElement("input");n.appendChild(r),r.classList.add("broco-hidden-element"),r.value=e;for(var i=0;i<t.length;i++)r.addEventListener(t[i],this.on_update.bind(this));return r},n.prototype.clear=function(){this.element.value=""},n.prototype.focus=function(){this.element.focus()},n.prototype.blur=function(){this.element.blur()},n.prototype.has_focus=function(){return document.hasFocus()&&document.activeElement==this.element},n.prototype.get_value=function(){return this.element.value},n.prototype.get_position=function(){return this.focus(),this.element.selectionStart},n.prototype.on_update=function(t){this.on_change(this),t=t||event,t.keyCode==e.ENTER&&this.on_submit(this)},n}),define("broco/ui/prompt",["broco/ui/util","broco/ui/stringtracker"],function(e,t){function r(n){this.element=e.newClassDiv("broco-prompt"),this.text_element=document.createTextNode("");var r=e.newClassDiv("broco-prompt-text");r.appendChild(this.text_element),this.element.appendChild(r),this.prompt_string="$> ",this.tracker=new t("",this.on_change.bind(this),n,this.element),this.element.addEventListener("click",this.tracker.focus.bind(this.tracker)),this.reset_blink_timer(),this.display()}var n="â–“";return r.prototype.display=function(){var e=this.tracker.get_value();if(this.blink_state||!this.tracker.has_focus()){var t=this.tracker.get_position();t==e.length?e+=n:e=e.substr(0,t)+n+e.substr(t+1)}this.text_element.nodeValue=this.prompt_string+e},r.prototype.on_blink=function(){this.blink_state=!this.blink_state,this.display()},r.prototype.on_change=function(){this.reset_blink_timer(),this.display()},r.prototype.reset_blink_timer=function(){this.blink_timer!=undefined&&clearInterval(this.blink_timer),this.blink_timer=setInterval(this.on_blink.bind(this),500),this.blink_state=!0},r}),define("broco/ui/response",["broco/ui/util"],function(e){function t(e,t){return this._dir!=undefined&&this._dir.indexOf(e)==-1?undefined:t}function n(e){return typeof e=="string"?e:JSON.stringify(e,t,2)}function r(){this.element=e.newClassDiv("broco-entry-response")}return r.prototype.append=function(e){return this.element.appendChild(e),this},r.prototype.print=function(t,r){t=n(t);var i=e.newClassDiv("broco-entry-response-line"),s=document.createTextNode(t);i.appendChild(s),r||(r=[]);for(var o=0;o<r.length;o++)i.classList.add(r[o]);return this.append(i),this},r.prototype.print_n=function(e,t){for(var n=0;n<e.length;n++)this.print(e[n],t);return this},r.prototype.print_split=function(e,t){return this.print_n(e.split("\n"))},r}),define("broco/ui/core",["broco/ui/util","broco/ui/prompt","broco/ui/response"],function(e,t,n){function r(n,r){this.element=document.querySelector(n),this.element.classList.add("broco-console"),this.entries=e.newClassDiv("broco-entries"),this.element.appendChild(this.entries),this.console=r,this.console.ui=this,this.prompt=new t(this.on_submit.bind(this)),this.element.appendChild(this.prompt.element)}return r.prototype.domCommand=function(t){var n=e.newClassDiv("broco-entry-command"),r=document.createTextNode(t);return n.appendChild(r),n},r.prototype.append=function(e){this.entries.appendChild(e)},r.prototype.appendCommand=function(e){this.append(this.domCommand(e))},r.prototype.process=function(e){var t=new n;this.appendCommand(this.prompt.prompt_string+e),this.console.process(e,t),this.append(t.element)},r.prototype.on_submit=function(e){var t=e.get_value();e.clear(),this.element.scrollTop=this.element.scrollHeight,t!=""&&this.process(t)},r}),define("vendor/domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t+=1)e[t](s)}function a(){var e=o;i&&e.length&&(o=[],u(e))}function f(){i||(i=!0,n&&clearInterval(n),a())}function c(e){return i?e(s):o.push(e),c}var e,t,n,r=typeof window!="undefined"&&window.document,i=!r,s=r?document:null,o=[];if(r){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),t=document.createElement("div");try{e=window.frameElement===null}catch(l){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll(),f()}catch(e){}},30))}document.readyState==="complete"&&f()}return c.version="2.0.1",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),require.config({paths:{broco:"src"}}),define("demo",["broco/logic/console","broco/ui/core","vendor/domReady!"],function(e,t){var n=new e,r=new t("#console",n);n.depend("broco/modules/",["motd","load","help"],function(){n.modules.help.tutorials.getting_started=["You can load modules at run-time. Try this:","$> load broco/modules fullscreen","Now you have access to the `fullscreen` module. Give it a try!","$> fullscreen","Modules are just commands. Most projects using broco for their own purposes, will provide their own modules."],r.process("motd")})}),define("broco/logic/traversal",[],function(){function e(e,t){this.parent=e,this.key=t}return e.prototype.step=function(t){var n=this.parent[this.key];return new e(n,t)},e.prototype.navigate=function(e){var t=e.split("."),n=this;for(var r=0;r<t.length;r++)n=n.step(t[r]);return n},e.prototype.get=function(){return this.parent[this.key]},e.prototype.set=function(e){this.parent[this.key]=e},e}),define("broco/modules/get",["broco/logic/traversal"],function(e){function t(e){this.console=e,this._dir=[],this._help=["usage: get this.that","Returns a variable from the console data storage.","Use `get .` to see all available data."]}return t.prototype.usage=function(e){e.print_n(this._help)},t.prototype.process=function(t,n){if(t.length!=2)return this.usage(n);var r=t[1];try{var i=new e(this.console,"data"),s=r=="."?i:i.navigate(r);n.print(s.get())}catch(o){n.print(o.message,["broco-entry-error"])}},t}),define("broco/modules/set",["broco/logic/traversal"],function(e){function t(e){this.console=e,this._dir=[],this._help=['usage: set this.that = `"Some JSON Value"`',"Sets a variable in the console data storage.","This gives you full ability to overwrite module objects. You may need to reload them afterwards if you do stupid things. The console gives you all the tools you need to break everything and fix it again, and the safety is OFF."]}return t.prototype.usage=function(e){e.print_n(this._help)},t.prototype.process=function(t,n){if(t.length!=4)return this.usage(n);if(t[2]!="=")return this.usage(n);var r=t[1];try{var i=JSON.parse(t[3])}catch(s){return n.print("Bad JSON data",["broco-entry-error"])}try{var o=new e(this.console,"data"),u=r=="."?o:o.navigate(r);return u.set(i),n.print(u.get())}catch(s){return n.print(s.message,["broco-entry-error"])}},t}),define("broco/modules/clear",[],function(){function e(e){this.console=e,this._dir=[],this._help=["Clear the console output. Clean slate for thinking straight."]}return e.prototype.process=function(){var e=this.console.ui.entries;while(e.firstChild)e.removeChild(e.firstChild)},e});